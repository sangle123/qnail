jQuery(function($) {
  $(".dsm_post_carousel").each(function() {
    let $this = $(this);
    let data = $this.find(".dsm-post-carousel").data();
    var selector =
      "." +
      $this
        .attr("class")
        .split(" ")
        .join(".") +
      " .swiper-container";

    let navigation = {
      nextEl: ".dsm-post-arrow-button-next" + data.ordernumber,
      prevEl: ".dsm-post-arrow-button-prev" + data.ordernumber,
    };
    let pagination = {
      el: ".dsm-post-pagination" + data.ordernumber,
      clickable: true,
      type: "progressbar" !== data.pagiButtonStyle ? "bullets" : "progressbar",
      dynamicBullets: "dynamic" === data.pagiButtonStyle ? true : false,
    };

    let loop_infinte = data.loop === 1 ? true : false;
    let centered_slides = data.centered === "on" ? true : false;
    let slider_orientation = data.orientation;

    let DSM_PostCarousel = new Swiper(selector, {
      direction: slider_orientation,
      effect: data.effect,
      coverflowEffect: {
        slideShadows: data.effectShadows === "on" ? true : false,
        rotate: data.effectCoverflowRotate,
        depth: data.effectCoverflowDepth,
      },
      flipEffect: {
        rotate: 30,
        slideShadows: data.effectShadows === "on" ? true : false,
      },
      cubeEffect: {
        slideShadows: data.effectShadows === "on" ? true : false,
        shadow: data.effectShadows === "on" ? true : false,
        shadowOffset: 20,
        shadowScale: 0.94,
      },
      speed: Number(data.speed),
      loop: centered_slides === true ? true : loop_infinte,
      autoplay: {
        //enabled: params[0]['autoplay'],
        enabled: false,
        delay: data.autoplayspeed,
        disableOnInteraction: false,
      },
      mousewheel: data.mousewheel === "on" ? true : false,
      /*
            autoplay: "on" === data.autoplay && {
                delay: data.autoplayspeed
            },*/
      setWrapperSize:
        "cube" === data.effect || "flip" === data.effect ? false : true,
      observer: true,
      observeParents: true,
      observeSlideChildren: true,
      slideClass: "dsm-post-carousel-item",
      wrapperClass: "dsm-post-carousel-wrapper",
      navigation: navigation,
      pagination: pagination,
      centeredSlides: centered_slides,
      slidesPerColumn: data.multiRow === "on" ? Number(data.row) : 1,
      slidesPerColumnFill: "row",
      grabCursor: data.grab === "on" ? true : false,
      allowTouchMove: data.touchMove === "off" ? true : false,
      breakpoints: {
        320: {
          slidesPerView:
            "cube" === data.effect || "flip" === data.effect
              ? 1
              : Number(data.columnsphone),
          spaceBetween:
            "cube" === data.effect || "flip" === data.effect
              ? 0
              : Number(data.spacingphone),
          slidesPerColumn: data.multiRow === "on" ? Number(data.rowsphone) : 1,
          slidesPerColumnFill: "row",
        },
        480: {
          slidesPerView:
            "cube" === data.effect || "flip" === data.effect
              ? 1
              : Number(data.columnsphone),
          spaceBetween:
            "cube" === data.effect || "flip" === data.effect
              ? 0
              : Number(data.spacingphone),
          slidesPerColumn: data.multiRow === "on" ? Number(data.rowsphone) : 1,
          slidesPerColumnFill: "row",
        },
        768: {
          slidesPerView:
            "cube" === data.effect || "flip" === data.effect
              ? 1
              : Number(data.columnstablet),
          spaceBetween:
            "cube" === data.effect || "flip" === data.effect
              ? 0
              : Number(data.spacingtablet),
          slidesPerColumn: data.multiRow === "on" ? Number(data.rowstablet) : 1,
          slidesPerColumnFill: "row",
        },
        981: {
          slidesPerView:
            "cube" === data.effect || "flip" === data.effect
              ? 1
              : Number(data.columnsdesktop),
          spaceBetween:
            "cube" === data.effect || "flip" === data.effect
              ? 0
              : Number(data.spacing),
          slidesPerColumn: data.multiRow === "on" ? Number(data.row) : 1,
          slidesPerColumnFill: "row",
        },
      },
    });

    if (data.pauseOnHover === "on") {
      $(this).on("mouseenter", function(e) {
        DSM_PostCarousel.autoplay.stop();
      });
      $(this).on("mouseleave", function(e) {
        DSM_PostCarousel.autoplay.start();
      });
    }
    if (data.autoplay === "on") {
      if (typeof Waypoint === "undefined") {
        DSM_PostCarousel.autoplay.start();
      } else {
        var waypoint = new Waypoint({
          element: $(this),
          handler: function(direction) {
            DSM_PostCarousel.autoplay.start();
            this.destroy();
          },
          offset: data.autoplayViewport,
        });
      }
    }
  });
});
